<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>RouteMap</title>
    <script type="text/javascript" src="js/echarts.min.js"></script>
    <script type="text/javascript" src="js/world.js"></script>
</head>
<body>
<div id="main" style="width: 100%; height:700px;"></div>

<script>
    var chart = echarts.init(document.getElementById("main"));
    var geoCoordMap = {
    London: [-0.1278, 51.5074],
    Perth: [115.8605, -31.9505],
    HongKong: [114.1694, 22.3193],
    Singapore: [103.8198, 1.3521],
    Tokyo: [139.7690, 35.6804],
    Chicago:[-87.6298, 41.8781],
    NewYork:[-74.0060,40.7128],
    Muscat: [58.3829, 23.5868],
    LosAngeles: [-118.2437, 34.0522],
    AbuDhabi: [54.3773, 24.4537],
    Boston: [-71.0589, 42.3601],
    Washington: [-77.0369, 38.9073],
    Bahrain: [50.5077, 26.0667],
    AddisAbaba:[38.7578, 8.9806],
    Doha: [51.5310, 25.2871],
    Toronto: [-79.3832, 43.6532],
    Dallas:[-96.7970, 32.7663],
    Delhi: [77.1021, 28.7041],
    Paris: [2.3522, 48.8566],
    Dublin: [-6.2530, 53.3413],
    TelAviv: [34.7818, 32.0344],
    Frankfurt: [8.6820, 50.1109],
    Cork: [-8.4756, 51.8972],
    Copenhagen: [12.5682, 55.6761],
    Hanoi: [105.8342, 21.0283],
    Shannon: [-8.8730, 52.7125],
    Helsinki: [24.9384, 60.1699],
    Oslo: [10.7522, 59.9139],
    Miami: [-80.1918, 25.7633],
    Stockholm: [18.0686, 59.3294],
    Amsterdam: [4.8945, 52.3667],
    Luqa: [14.4896, 35.8538],
    Belfast: [-5.9304, 54.5973],
    Ahmedabad: [72.5714, 23.0225],
    Atlanta: [-84.3880, 33.7403],
    Rome: [12.4964, 41.9028],
    Mumbai: [72.8777, 19.0760],
    Dusseldorf: [6.7735, 51.2277],
    Milan: [9.1900, 45.4642],
    Dubai: [55.2708, 25.2049],
    Belgrade: [55.2708, 25.2048],
    Jeddah: [39.1925,21.4858],
    Reykjavik: [-21.9426, 64.1644],
    SanFrancisco: [-122.4192, 37.7759],
    Berlin: [13.4028, 52.5200],
    Cairo: [31.2357, 30.0444],
    Geneva: [6.1432, 46.2044],
    Tunis: [9.5375, 33.8863],
    Nice: [7.2620, 43.7102],
    Guangzhou: [113.2644, 23.1291],
    Edinburgh: [-3.1833, 55.9533],
    Dhaka: [90.4125, 23.8103],
    Islamabad: [73.0479, 33.6844],
    Riyadh: [46.6753, 24.7136],
    Sofia: [23.3219, 42.6977],
    Cincinnati: [-84.5120, 39.1031],
    Seoul: [126.9780, 37.5656],
    IsleOfMan: [-4.5481, 54.2361],
    Madrid: [-3.7038, 40.4168],
    Stavanger: [5.7331, 58.9700],
    Gibraltar: [-5.3536, 36.1408],
    Bangkok: [100.5018, 13.7563],
    Colombo: [79.8612, 6.9271],
    Porto: [-8.6291, 41.1579],
    Bridgetown: [-59.6131, 13.1060]
};
var BJData = [
    [{
        name: "Perth",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "HongKong",
        value: 3
    }, {
        name: "London"
    }],
    [{
        name: "Singapore",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Tokyo",
        value: 2
    }, {
        name: "London"
    }],
    [{
        name: "Chicago",
        value: 3
    }, {
        name: "London"
    }],
    [{
        name: "NewYork",
        value: 9
    }, {
        name: "London"
    }],
    [{
        name: "Muscat",
        value: 2
    }, {
        name: "London"
    }],
    [{
        name: "AbuDhabi",
        value: 3
    }, {
        name: "London"
    }],
    [{
        name: "LosAngeles",
        value: 3
    }, {
        name: "London"
    }],
    [{
        name: "Boston",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Washington",
        value: 2
    }, {
        name: "London"
    }],
    [{
        name: "Bahrain",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "AddisAbaba",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Doha",
        value: 3
    }, {
        name: "London"
    }],
    [{
        name: "Toronto",
        value: 3
    }, {
        name: "London"
    }],
    [{
        name: "Dallas",
        value: 2
    }, {
        name: "London"
    }],
    [{
        name: "Delhi",
        value: 2
    }, {
        name: "London"
    }],
    [{
        name: "Paris",
        value: 2
    }, {
        name: "London"
    }],
    [{
        name: "Dublin",
        value: 12
    }, {
        name: "London"
    }],
    [{
        name: "TelAviv",
        value: 2
    }, {
        name: "London"
    }],
    [{
        name: "Frankfurt",
        value: 3
    }, {
        name: "London"
    }],
    [{
        name: "Cork",
        value: 4
    }, {
        name: "London"
    }],
    [{
        name: "Copenhagen",
        value: 5
    }, {
        name: "London"
    }],
    [{
        name: "Hanoi",
        value: 2
    }, {
        name: "London"
    }],
    [{
        name: "Shannon",
        value: 3
    }, {
        name: "London"
    }],
    [{
        name: "Helsinki",
        value: 2
    }, {
        name: "London"
    }],
    [{
        name: "Oslo",
        value: 5
    }, {
        name: "London"
    }],
    [{
        name: "Miami",
        value: 2
    }, {
        name: "London"
    }],
    [{
        name: "Stockholm",
        value: 6
    }, {
        name: "London"
    }],
    [{
        name: "Amsterdam",
        value: 2
    }, {
        name: "London"
    }],
    [{
        name: "Luqa",
        value: 2
    }, {
        name: "London"
    }],
    [{
        name: "Belfast",
        value: 4
    }, {
        name: "London"
    }],
    [{
        name: "Ahmedabad",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Atlanta",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Rome",
        value: 3
    }, {
        name: "London"
    }],
    [{
        name: "Mumbai",
        value: 2
    }, {
        name: "London"
    }],
    [{
        name: "Dusseldorf",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Milan",
        value: 3
    }, {
        name: "London"
    }],
    [{
        name: "Dubai",
        value: 3
    }, {
        name: "London"
    }],
    [{
        name: "Belgrade",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Jeddah",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Reykjavik",
        value: 2
    }, {
        name: "London"
    }],
    [{
        name: "SanFrancisco",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Berlin",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Cairo",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Geneva",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Tunis",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Nice",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Guangzhou",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Edinburgh",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Dhaka",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Islamabad",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Riyadh",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Sofia",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Cincinnati",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Seoul",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "IsleOfMan",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Madrid",
        value: 2
    }, {
        name: "London"
    }],
    [{
        name: "Stavanger",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Gibraltar",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Bangkok",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Colombo",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Porto",
        value: 1
    }, {
        name: "London"
    }],
    [{
        name: "Bridgetown",
        value: 1
    }, {
        name: "London"
    }]
];
var convertData = function(data) {
    var res = [];
    for (var i = 0; i < data.length; i++) {
        var dataItem = data[i];
        var fromCoord = geoCoordMap[dataItem[0].name];
        var toCoord = geoCoordMap[dataItem[1].name];
        if (fromCoord && toCoord) {
            res.push([{
                    coord: fromCoord,
                    value: dataItem[0].value
                },
                {
                    coord: toCoord
                }
            ]);
        }
    }
    return res;
};


var series = [];
[
    ["London", BJData]
].forEach(function(item, i) {
    series.push({
            type: "lines",
            zlevel: 2,
            effect: {
                show: true,
                period: 4, //箭头指向速度，值越小速度越快
                trailLength: 0.21, //特效尾迹长度[0,1]值越大，尾迹越长重
                symbol: "arrow", //箭头图标
                symbolSize: 3 //图标大小
            },
            lineStyle: {
                normal: {
                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                        offset: 0,
                        color: '#58B3CC'
                    }, {
                        offset: 1,
                        color: '#F58158'
                    }], false),
                    width: 1,
                    opacity: 0.03,
                    curveness: 0.1
                }
            },

            data: convertData(item[1])
        }, {
            type: "effectScatter",
            coordinateSystem: "geo",
            zlevel: 2,
            rippleEffect: {
                //涟漪特效
                period: 4, //动画时间，值越小速度越快
                brushType: "stroke", //波纹绘制方式 stroke, fill
                scale: 4 //波纹圆环最大限制，值越大波纹越大
            },
            label: {
                normal: {
                    show: true,
                    position: "right", //显示位置
                    offset: [5, 0], //偏移设置
                    formatter: "{b}" //圆环显示文字
                },
                emphasis: {
                    show: true
                }
            },
            symbol: "circle",
            symbolSize: function(val) {
                return 4 + val[2] / 1000; //圆环大小
            },
            itemStyle: {
                normal: {
                    show: false,
                }
            },
            data: item[1].map(function(dataItem) {
                return {
                    name: dataItem[0].name,
                    value: geoCoordMap[dataItem[0].name].concat([dataItem[0].value])
                };
            })
        },
        //被攻击点
        {
            type: "scatter",
            coordinateSystem: "geo",
            zlevel: 2,
            rippleEffect: {
                period: 4,
                brushType: "stroke",
                scale: 4
            },
            label: {
                normal: {
                    show: true,
                    position: "right",
                    color: "#00ffff",
                    formatter: "{b}",
                    textStyle: {
                        color: "#0bc7f3"
                    }
                },
                emphasis: {
                    show: true
                }
            },
            symbol: "pin",
            symbolSize: 30,
            itemStyle: {
                normal: {
                    show: true,
                    color: "#9966cc"
                }
            },
            data: [{
                name: item[0],
                value: geoCoordMap[item[0]].concat([100])
            }]
        }
    );
});

option = {
    backgroundColor: '#000',
    title: {
        text: 'Heathrow Routemap',
        left: 'center',
        textStyle: {
            color: '#fff'
        }
    },
    tooltip: {
        trigger: "item",
        backgroundColor: "#1540a1",
        borderColor: "#FFFFCC",
        showDelay: 0,
        hideDelay: 0,
        enterable: true,
        transitionDuration: 0,
        extraCssText: "z-index:300",
        formatter: function(params, ticket, callback) {
            //根据业务自己拓展要显示的内容
            var res = "";
            var name = params.name;
            var value = params.value[params.seriesIndex + 1];
            res =
                "<span style='color:#fff;'>" +
                name +
                "</span><br/>numbers of flights：" + value;
            return res;
        }
    },
    visualMap: {
        //图例值控制
        min: 0,
        max: 10000,
        show: false,
        calculable: true,
        color: ["#0bc7f3"],
        textStyle: {
            color: "#fff"
        },

    },
    geo: {
        map: "world",
        label: {
            emphasis: {
                show: true
            }
        },
        roam: true, //是否允许缩放
        layoutCenter: ["50%", "50%"], //地图位置
        layoutSize: "180%",
        itemStyle: {
            normal: {
                areaColor: '#323c48',
                borderColor: '#8F98A6'
            },
            emphasis: {
                areaColor: '#2a333d'
            }
        }
    },

    series: series
};
    chart.setOption(option);
</script>
</body>
</html>
